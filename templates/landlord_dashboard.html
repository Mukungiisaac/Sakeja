{% extends 'base.html' %}
{% block content %}

<h2>Welcome, {{ current_user.name }} </h2>
<a href="{{ url_for('post_house') }}" class="btn">+ Post New House</a>

<h3>Your House Listings</h3>

{% if houses %}
<table>
  <thead>
    <tr>
      <th>Photo</th>
      <th>Title</th>
      <th>Type</th>
      <th>Location</th>
      <th>Rent (Ksh)</th>
      <th>Deposit (Ksh)</th>
      <th>Distance (KM)</th>
      <th>Water</th>
      <th>WiFi</th>
      <th>Phone</th>
      <th>Actions</th>

    </tr>
  </thead>
  <tbody>
    {% for house in houses %}
    <tr>
      <td>
        <img src="{{ url_for('static', filename='uploads/' + house.photo) }}" width="100">
      </td>
      <td>{{ house.title }}</td>
      <td>{{ house.house_type }}</td>
      <td>{{ house.location }}</td>
      <td>{{ house.rent }}</td>
      <td>{{ house.deposit }}</td>
      <td>{{ house.distance }}</td>
      <td>{{ 'Yes' if house.water else 'No' }}</td>
      <td>{{ 'Yes' if house.wifi else 'No' }}</td>
      <td>{{ house.contact_number }}</td>
      <td>
  <a href="{{ url_for('edit_house', house_id=house.id) }}" class="btn-edit">Edit</a>
  <a href="{{ url_for('delete_house', house_id=house.id) }}" class="btn-delete" onclick="return confirm('Are you sure you want to delete this house?');">Delete</a>
</td>

    </tr>
    {% endfor %}
  </tbody>
</table>
<h2>Bookings</h2>

{% if bookings %}
  <table class="bookings-table">
    <thead>
      <tr>
        <th>House</th>
        <th>Student Name</th>
        <th>Email</th>
        <th>Phone</th>
        <th>REG Number</th>
        <th>Move-In Date</th>
        <th>Message</th>
        <th>Time</th>
      </tr>
    </thead>
    <tbody>
      {% for booking in bookings %}
      <tr>
        <td>{{ booking.house.title }}</td>
        <td>{{ booking.student_name }}</td>
        <td>{{ booking.student_email }}</td>
        <td>{{ booking.student_phone }}</td>
        <td>{{ booking.reg_number }}</td>
        <td>{{ booking.move_in_date }}</td>
        <td>{{ booking.message }}</td>
        <td>{{ booking.timestamp.strftime('%Y-%m-%d %H:%M') }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
{% else %}
  <p>No bookings yet.</p>
{% endif %}

{% else %}
  <p>You have not posted any houses yet.</p>
{% endif %}

{% endblock %}
